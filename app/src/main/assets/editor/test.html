<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <textarea bind="textarea"
        style="width: 100%;height: 300px;resize: none;"># Excel|[]

打开或关闭筛选
                  
1. 选择数据区域或表格中的任意单元格。
             
2. 执行以下任一操作：
                
在“开始”选项卡上的“编辑”组中，选择“排序和筛选”，然后选择“筛选”。        
按 Ctrl+Shift+L。
                  
        
        To create a selection filter
        
        Turn on filtering.
        
        Select the filter arrow for the column by which you want to filter the data range or table.
        
        Do either of the following:
        
        Clear the checkboxes next to the items you want to hide.
        
        Clear the Select All checkbox and then select the checkboxes next to the items you want to display.
        
        Select OK to apply the filter.
        
        To create a filter rule
        
        With filtering turned on, select the filter arrow for the column by which you want to filter the data range or table.
        
        Select Type Filters to display the available filters for the column’s data type.
        
        Select the filter you want to create.
        
        Enter the arguments required to define the rule, and then select OK to apply the filter.
        
        To display the highest or lowest numeric values in a column
        
        With filtering turned on, select the filter arrow for a column that contains numeric values, select Number Filters, and then select Top 10.
        
        In the Top 10 AutoFilter dialog, do the following:
        
        In the first Show list, select Top or Bottom.
        
        In the second list, enter or select the number or percentage of items you want to display.
        
        In the third list, select Items to display the selected number of items or Percent to display the selected percentage of items.</textarea>
    <button bind @click="onFormatCode">插入</button>

    <script>
        function bind(elememnt) {
            (elememnt || document).querySelectorAll('[bind]').forEach(element => {
                if (element.getAttribute('bind')) {
                    window[element.getAttribute('bind')] = element;
                }
                [...element.attributes].filter(attr => attr.nodeName.startsWith('@')).forEach(attr => {
                    if (!attr.value) return;
                    element.addEventListener(attr.nodeName.slice(1), evt => {
                        window[attr.value](evt);
                    });
                });
            })
        }
    </script>
    <script>
        function findCodeBlock(textarea) {
            const value = textarea.value;
            let start = textarea.selectionStart;
            let end = textarea.selectionEnd;
            while (start > -1) {
                if (value[start] === '`' && value[start - 1] === '`' && value[start - 2] === '`') {
                    start += 1;
                    while (start < value.length) {
                        if (value[start] === '\n') {
                            start++;
                            break;
                        }
                        start++;
                    }
                    break;
                }
                start--;
            }
            while (end < value.length) {
                if (value[end] === '`' && value[end + 1] === '`' && value[end + 2] === '`') {
                    end--;
                    break;
                }
                end++;
            }
            return [start, end];
        }
        bind();
        function getIndexLine(textarea, index) {
            let start = index || textarea.selectionStart;
            const strings = textarea.value;
            if (strings[start] === '\n' && start - 1 > 0) {
                start--;
            }
            while (start > 0 && strings[start - 1] !== '\n') {
                start--;
            }
            let end = index || textarea.selectionEnd;
            while (end + 1 < strings.length && strings[end] !== '\n') {
                end++;
            }
            return [strings.substring(start, end), start, end]
        }
        function onFormatCode() {
            let p = getIndexLine(textarea);
            let p1 = p;
            while (true) {
                if (p1[1] <= 0) {
                    break;
                }
                let p2 = getIndexLine(textarea, p1[1] - 1);
                if (p2[0].trim()) {
                    
                    if (/(\d+). /.test(p2[0])) {
                        textarea.setRangeText(`    - ${p[0]}`,
                            p[1], p[2], 'end')
                        return;
                    } else  if (/ +- /.test(p2[0])){
                        textarea.setRangeText(`${/( +)- /.exec(p2[0])[1]}- ${p[0]}`,
                            p[1], p[2], 'end')
                        return;
                    }else{
                        textarea.setRangeText(`- ${p[0]}`,
                            p[1], p[2], 'end')
                        return;  
                    }
                }
                p1 = p2;

            }
            textarea.setRangeText(`- ${p[0]}`,
                            p[1], p[2], 'end')

        }
        function onShow() {
            actions.style.display = 'block';
        }
    </script>

</body>

</html>